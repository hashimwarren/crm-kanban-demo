# Copilot Instructions for this Repository

## Overview

This repository is a modern CRM application built with Next.js, Drizzle ORM, Neon, shadcn/ui, and Clerk. **Demo mode has been completely removed** and the application now requires Clerk authentication and Neon database for all functionality.

---

## How the App Works (Production State)

- **Authentication:**
  - Clerk integration is fully enabled and required for all protected routes.
  - Custom sign-in/sign-up pages use Clerk components for a branded experience.
  - Middleware enforces authentication before accessing any protected routes.

- **Database & Data:**
  - Drizzle ORM and Neon database are fully connected and operational.
  - All CRUD operations use the real database—no mock data remains.
  - User data is automatically synced between Clerk and the database.

- **Core Features:**
  - **Dashboard:** Real stats, leads, and activity data from the database.
  - **Leads Management:** Full CRUD operations with database persistence.
  - **Deals Management:** Real deal tracking with database storage.
  - **Kanban Board:** Drag-and-drop pipeline with real data.
  - **API Routes:** All secured with Clerk authentication, return real data.

- **Security:**
  - All protected routes require Clerk authentication.
  - API endpoints return 401 for unauthenticated requests and log unauthorized access attempts.
  - No demo bypasses or authentication stubs remain.

- **UI Components:**
  - Built with shadcn/ui for consistent, accessible design.
  - Includes forms, tables, cards, stats, dialogs, and navigation components.
  - Navigation links are only rendered for authenticated users.

- **Testing:**
  - **Jest** for unit/component tests (all passing).
  - **Playwright** for E2E tests (authentication flows and real data interactions).
  - Tests updated to work with real authentication and database requirements.

- **Development Experience:**
  - Hot reload, TypeScript, ESLint, optimized builds.
  - Requires valid Clerk and Neon credentials to run.

---

## Project Structure

```
test-planning/
├── src/
│   ├── app/                 # Next.js app router pages
│   │   ├── dashboard/       # Dashboard with stats and overview
│   │   ├── leads/           # Lead management and forms
│   │   ├── deals/           # Deal management tables
│   │   ├── kanban/          # Kanban board interface
│   │   └── sign-in,sign-up/ # Authentication pages (Clerk)
│   ├── components/          # Reusable UI components
│   │   ├── ui/              # shadcn/ui components
│   │   └── dashboard-layout.tsx
│   ├── db/                  # Database schema and config
│   └── lib/                 # Utilities and helpers
├── tests/                   # Playwright E2E tests
├── drizzle/                 # Database migrations
└── Configuration files      # Next, TypeScript, Tailwind, etc.
```

---

## Development & Testing Commands

```bash
# Development
npm run dev              # Start development server
npm run build            # Build for production
npm run start            # Start production server

# Testing
npm run test             # Run unit tests (Jest)
npm run test:watch       # Run tests in watch mode
npm run test:e2e         # Run E2E tests (Playwright)
npm run test:e2e:ui      # Run E2E tests with UI

# Database
npx drizzle-kit generate # Generate migrations
npx drizzle-kit push     # Push schema to database
```

---

## Design System

- **Color Scheme:** Professional blue/gray theme
- **Typography:** System fonts with hierarchy
- **Spacing:** Consistent padding and margins
- **Components:** shadcn/ui for all UI
- **Icons:** Lucide React
- **Responsive:** Mobile-first design

---

## Production Readiness

- **Authentication:** Clerk is required for all protected routes and API endpoints.
- **Database:** All CRUD operations use Neon via Drizzle ORM; no mock/demo data remains.
- **Navigation:** Navigation links are only visible to authenticated users.
- **Error Handling:** Unauthorized API/page access is logged and returns 401 or redirects to sign-in.
- **Drizzle Config:** Schema path is set to `./src/app/db/schema.ts` and CLI is verified to work.
- **Testing:** All Playwright and Jest tests must pass after any code changes.

---

**Status:**

- Production application
- All tests passing
- Ready for deployment
- Last updated: July 1, 2025
